---
title: "Go を2年くらい書いた感想: 意図をエンコードしきれない感じは消えず"
date: 2021-10-22T18:48:22-07:00
---
ここ2年くらい、仕事では大体 Go を書いている。jmuk さんが

> Go言語は、なんというか「ちょうどいい」言語だな、と思っている。異論は認める。

[と書いていたけれど](https://messagepassing.github.io/008-justright/04-jmuk/)、私はやっぱり Scala や Kotlin あたりが好きで、これは変わらなそう。

例えばコレクションを map しているのをみると、私は「なるほど、ここではコレクションの要素数は変わらないんですね」と思う。filter だったら「コレクションの要素数は変わるけど、個々の要素は変わらない」ということを、あるいは Result を map していたら「ここではエラーのほうは触らないのね」ということを読みとっている。

こういう意図が、素朴な `for` ループと、`if err != nil` だと読みきれなくて、いや真面目に字面を追っていけばわかるんだけど、なんか意図が即座には伝わらないというか、私が「map するか」と思いながら for ループを書いて、その for ループを誰かが読んで「これは map だね」と理解していることを考えると、それソースコードに map って書けたほうがいいんじゃない、と思ってしまう。

同様に、immutable なコレクションとか、一回代入されたら書き換えられない変数とか、`Optional<T>` のような nil にならない参照とかも欲しい。自分の意図をプログラミング言語の語彙でもってエンコードして、それを覆すようなことが起きたらコンパイラにエラーにして欲しい。

### 自分の語彙にない表現

一方で、私の語彙は、過去の経験からくるバラバラな機能のセットでしかなくて、それが Scala や Kotlin のところで止まっていることには一抹の不安もある。

Idris にある依存型とか、[Cats](https://typelevel.org/cats/) や [Scalaz](https://github.com/scalaz/scalaz) が提供する色々とか、Rust のオーナーシップとか、存在を知っているけど使い道がわかっていないものは色々あって、どうしたものかなあと思う。Idris なら [Seven More Languages in Seven Weeks](https://pragprog.com/titles/7lang/seven-more-languages-in-seven-weeks/) に出てくるので、そこだけでも読むといいのかもしれない。

Go の人々の素朴さへの渇望みたいなものは、多機能な言語の、その機能を使いまくってヤバいコードを仕事でさわるといいのかもしれないけれど、これは経験したくはないなあ。
